# 常见问题解答（FAQ?

## 安装和部?

### Q: 需要什么环境？
A: 需?Node.js 16+ ?npm。如果要使用自动生成补丁功能，还需?Java 11+?

### Q: 如何修改默认端口?
A: 编辑 `backend/.env` 文件，修?`PORT=3000` 为你想要的端口?

### Q: 支持哪些数据库？
A: 默认使用 SQLite，也支持 MySQL。在 `.env` 文件中配?`DB_TYPE`?

### Q: 如何部署到生产环境？
A: 推荐使用 Docker 部署，或者使?PM2 管理 Node.js 进程。详?README.md 的部署章节?

## 功能使用

### Q: 如何创建第一个应用？
A: 登录后台后，点击"创建应用"按钮，填写应用名称和包名即可?

### Q: 如何上传补丁?
A: 进入应用详情页，点击"上传补丁"，选择补丁文件并填写版本信息?

### Q: 什么是灰度发布?
A: 灰度发布允许你只向部分用户推送补丁，通过设置百分比（0-100%）来控制推送范围?

### Q: 如何设置强制更新?
A: 在上传或编辑补丁时，勾?强制更新"选项即可?

### Q: 补丁加密如何使用?
A: 在应用设置中配置加密密钥，上传的补丁会自动加密。客户端需要使用相同密钥解密?

## 权限和安?

### Q: 如何修改管理员密码？
A: 登录后点击右上角用户名，选择"修改密码"?

### Q: 普通用户和管理员有什么区别？
A: 管理员可以查看所有应用、管理用户、访问系统设置。普通用户只能管理自己的应用?

### Q: 如何启用应用审核?
A: 在系统设?-> 审核设置中，开?启用应用审核"?

### Q: 如何封禁用户?
A: 在用户管理页面，点击用户操作菜单，选择"封禁用户"?

## 故障排查

### Q: 登录后显示空白页面？
A: 检查浏览器控制台是否有错误，清除浏览器缓存后重试?

### Q: 上传补丁失败?
A: 检查文件大小是否超过限制（默认 100MB），检?uploads 目录权限?

### Q: 生成补丁时提?无需生成补丁"?
A: 这表示两?APK 版本的内容完全相同，没有任何差异。请检查：
- 是否上传了相同的 APK 文件
- 新版?APK 是否真的包含了代码或资源的修?
- 版本号是否正确（即使版本号不同，如果内容一样也不会生成补丁?

**注意**：从 v1.3.2 版本开始，字符串常量的修改也会被检测到。如果使用旧版本，只修改硬编码字符串可能不会生成补丁?

补丁生成器会比较以下内容?
- **Dex 文件**：Java/Kotlin 代码编译后的字节码（包括字符串常量）
- **资源文件**：res 目录下的所有资源（布局、图片、字符串等）
- **Assets 文件**：assets 目录下的所有文?

只有当至少有一项发生变化时，才会生成补丁?

### Q: 什么情况下补丁生成会失败？
A: 补丁生成可能在以下情况下失败?

**环境问题**?
- Java 未安装或版本过低（需?Java 11+?
- patch-cli JAR 文件未找到或配置错误
- 磁盘空间不足

**文件问题**?
- APK 文件损坏或格式不正确
- 无法读取 APK 文件（权限问题）
- 输出目录无写入权?

**内容问题**?
- 两个 APK 版本内容完全相同（会提示"无需生成补丁"?
- APK 签名不一致（如果启用了签名验证）

**其他问题**?
- 网络超时（上传大文件时）
- 服务器内存不?
- 用户取消操作

### Q: API 请求失败?
A: 检查后端服务是否正常运行，检?CORS 配置是否正确?

### Q: 数据库连接失败？
A: 检查数据库配置是否正确，检查数据库文件权限?

## 客户端集?

### Q: 客户端如何检查更新？
A: 调用 `/api/client/check-update` 接口，传?appId、version ?deviceId?

### Q: 如何获取 appId?
A: 在应用设置页面可以看到应?ID，点击复制按钮即可?

### Q: 补丁下载失败怎么办？
A: 检查网络连接，检查补丁文件是否存在，检?MD5 校验是否通过?

### Q: 如何上报下载结果?
A: 调用 `/api/client/report` 接口，传?patchId、deviceId、success 等参数?

## 数据管理

### Q: 如何备份数据?
A: 在系统设?-> 备份管理中，点击"立即备份"。也可以启用定时自动备份?

### Q: 如何恢复备份?
A: 在备份列表中，点?恢复"按钮，确认后即可恢复?

### Q: 如何清理旧数据？
A: 在系统设?-> 数据清理中，可以清理日志和下载记录。也可以启用定时自动清理?

### Q: 操作日志保存多久?
A: 默认保存 30 天，可以在定时任务中修改清理策略?

## 性能优化

### Q: 如何提升下载速度?
A: 使用 CDN 加速补丁文件下载，配置 `CDN_URL` 环境变量?

### Q: 数据库性能优化?
A: 对于大量数据，建议使?MySQL 替代 SQLite，并添加适当的索引?

### Q: 如何减少服务器负载？
A: 启用缓存、使用负载均衡、优化数据库查询?

## 其他问题

### Q: 支持多语言吗？
A: 目前仅支持中文，后续版本会添加多语言支持?

### Q: 可以自定义主题吗?
A: 可以修改 `frontend/src/styles/variables.css` 来自定义颜色主题?

### Q: 如何贡献代码?
A: 欢迎提交 Pull Request ?GitHub 仓库?

### Q: 遇到 Bug 怎么办？
A: 请在 GitHub Issues 中报告问题，提供详细的错误信息和复现步骤?

